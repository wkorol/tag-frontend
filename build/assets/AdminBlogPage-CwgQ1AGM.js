import{e as L,n as P,r as n,j as e}from"./index-r4Ouve-b.js";import{g as T}from"./api-KPPBra2D.js";const h={slug:"",locale:"en",title:"",content:"",metaDescription:"",published:!1,ogImageUrl:""};function B(){var C;L("Admin Blog");const[D]=P(),i=(C=D.get("token"))!=null?C:"",[N,S]=n.useState([]),[p,g]=n.useState(!0),[b,j]=n.useState(null),[d,m]=n.useState(null),[l,x]=n.useState(h),[w,y]=n.useState(!1),[k,o]=n.useState(null),u=T(),v=()=>{if(!i){j("Missing admin token."),g(!1);return}g(!0),fetch(`${u}/api/admin/blog/articles?token=${encodeURIComponent(i)}`).then(async t=>{var a;const s=await t.json().catch(()=>null);if(!t.ok)throw new Error((a=s==null?void 0:s.error)!=null?a:"Failed to load articles.");return s}).then(t=>{var s;S((s=t==null?void 0:t.articles)!=null?s:[]),j(null)}).catch(t=>j(t.message)).finally(()=>g(!1))};n.useEffect(()=>{v()},[i]);const A=()=>{m("new"),x(h),o(null)},E=t=>{var s;m(t.id),x({slug:t.slug,locale:t.locale,title:t.title,content:t.content,metaDescription:t.metaDescription,published:t.published,ogImageUrl:(s=t.ogImageUrl)!=null?s:""}),o(null)},U=()=>{m(null),x(h),o(null)},I=async()=>{var t;y(!0),o(null);try{const s=d==="new",a=s?`${u}/api/admin/blog/articles?token=${encodeURIComponent(i)}`:`${u}/api/admin/blog/articles/${d}?token=${encodeURIComponent(i)}`,c=await fetch(a,{method:s?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:l.slug,locale:l.locale,title:l.title,content:l.content,metaDescription:l.metaDescription,published:l.published,ogImageUrl:l.ogImageUrl||null})}),f=await c.json().catch(()=>null);if(!c.ok)throw new Error((t=f==null?void 0:f.error)!=null?t:"Failed to save article.");o(s?"Article created.":"Article updated."),m(null),x(h),v()}catch(s){o(s.message)}finally{y(!1)}},$=async t=>{var s;if(confirm("Delete this article?"))try{const a=await fetch(`${u}/api/admin/blog/articles/${t}?token=${encodeURIComponent(i)}`,{method:"DELETE"});if(!a.ok){const c=await a.json().catch(()=>null);throw new Error((s=c==null?void 0:c.error)!=null?s:"Failed to delete article.")}v()}catch(a){o(a.message)}},r=(t,s)=>{x(a=>({...a,[t]:s}))};return e.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-10",children:e.jsxs("div",{className:"mx-auto max-w-5xl",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl text-slate-900",children:"Admin Blog"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Manage blog articles."})]}),!d&&e.jsx("button",{onClick:A,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:"New Article"})]}),k&&e.jsx("div",{className:"mb-4 rounded-lg border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-800",children:k}),p&&e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-6 text-slate-600",children:"Loading articles..."}),!p&&b&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-6 text-red-700",children:b}),d&&e.jsxs("div",{className:"mb-6 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("h2",{className:"mb-4 text-lg font-medium text-slate-900",children:d==="new"?"Create Article":"Edit Article"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Slug"}),e.jsx("input",{type:"text",value:l.slug,onChange:t=>r("slug",t.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"my-article-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Locale"}),e.jsxs("select",{value:l.locale,onChange:t=>r("locale",t.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",children:[e.jsx("option",{value:"en",children:"en"}),e.jsx("option",{value:"pl",children:"pl"}),e.jsx("option",{value:"de",children:"de"}),e.jsx("option",{value:"fi",children:"fi"}),e.jsx("option",{value:"no",children:"no"}),e.jsx("option",{value:"sv",children:"sv"}),e.jsx("option",{value:"da",children:"da"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Title"}),e.jsx("input",{type:"text",value:l.title,onChange:t=>r("title",t.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Meta Description"}),e.jsx("input",{type:"text",value:l.metaDescription,onChange:t=>r("metaDescription",t.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"OG Image URL"}),e.jsx("input",{type:"text",value:l.ogImageUrl,onChange:t=>r("ogImageUrl",t.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Content (HTML)"}),e.jsx("textarea",{value:l.content,onChange:t=>r("content",t.target.value),rows:16,className:"w-full rounded-lg border border-slate-300 px-3 py-2 font-mono text-sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"published",checked:l.published,onChange:t=>r("published",t.target.checked),className:"h-4 w-4 rounded border-slate-300"}),e.jsx("label",{htmlFor:"published",className:"text-sm text-slate-700",children:"Published"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:I,disabled:w,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:w?"Saving...":"Save"}),e.jsx("button",{onClick:U,className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"})]})]})]}),!p&&!b&&!d&&e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 border-b border-slate-200 px-6 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500",children:[e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-1",children:"Locale"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2",children:"Date"}),e.jsx("div",{className:"col-span-3 text-right",children:"Actions"})]}),N.length===0&&e.jsx("div",{className:"px-6 py-8 text-sm text-slate-500",children:"No articles found."}),N.map(t=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 border-b border-slate-100 px-6 py-4 text-sm text-slate-700",children:[e.jsxs("div",{className:"col-span-4",children:[e.jsx("div",{className:"font-medium text-slate-900",children:t.title}),e.jsx("div",{className:"text-xs text-slate-500",children:t.slug})]}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"inline-flex rounded-full bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-700",children:t.locale})}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 text-xs font-medium ${t.published?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.published?"Published":"Draft"})}),e.jsx("div",{className:"col-span-2 text-xs text-slate-500",children:t.publishedAt?new Date(t.publishedAt).toLocaleDateString():new Date(t.createdAt).toLocaleDateString()}),e.jsxs("div",{className:"col-span-3 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>$(t.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Delete"})]})]},t.id))]})]})})}export{B as AdminBlogPage};
