import{r as f}from"./index-CrujqUws.js";import{g as m}from"./api-KPPBra2D.js";const i=1e3*60*60*6,h="eur-rate-cache";let n=null,c=0,o=null;const w=()=>n&&Date.now()-c<i?null:(o||(o=p().finally(()=>{o=null})),o),g=()=>{w()};async function p(){try{const a=m(),r=await fetch(`${a}/api/eur-rate`);if(!r.ok)return null;const e=await r.json(),t=typeof(e==null?void 0:e.rate)=="number"?e.rate:null;if(t&&(n=t,c=Date.now(),typeof window!="undefined"))try{localStorage.setItem(h,JSON.stringify({rate:t,at:c}))}catch{}return t}catch{return null}}function R(){const[a,r]=f.useState(()=>{if(n&&Date.now()-c<i)return n;if(typeof window!="undefined")try{const e=localStorage.getItem(h);if(e){const t=JSON.parse(e);if(t!=null&&t.rate&&(t!=null&&t.at)&&Date.now()-t.at<i)return n=t.rate,c=t.at,t.rate}}catch{}return null});return f.useEffect(()=>{if(n&&Date.now()-c<i)return;let e=!1;const t=u=>{u.then(l=>{!e&&l&&r(l)}).catch(()=>null)},s=()=>{const u=w();u&&t(u)};o?t(o):s();const d=window.setTimeout(()=>{!e&&!n&&s()},1500);return()=>{e=!0,window.clearTimeout(d)}},[]),a}function S(a,r){return!r||!Number.isFinite(a)?null:`~${Math.round(a*r)}EUR`}export{S as f,g as p,R as u};
